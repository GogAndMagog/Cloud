<h1>Облачное хранилище</h1>

<p>
Выполнен в рамках прохождения <a href="https://zhukovsd.github.io/java-backend-learning-course/projects/cloud-file-storage/">роадмапа Сергея Жукова</a>.
</p>

<p>
Представляет из себя урезанный аналог Google Drive или чего-то похожего. 
</p>

<h2>Технологии:</h2>

<ul>
<li>Spring Boot - фреймворк для написания бизнес-логики</li>
<li>Spring Security - авторизация и аутентификация</li>
<li>Spring Boot Tests - интеграционное тестирование</li>
<li>Testcontainers - интеграционное тестирование</li>
<li>PostgreSQL - БД</li>
<li>Redis - Кэш</li>
<li>Minio - S3-хранилище</li>
<li>Docker - деплой</li>
</ul>

<h2>Установка</h2>

<p>
Для установки необходим установленный Docker на хост-машине. 
Установка производится запуском docker-compose.yaml из репозитория. 
</p>

Пример: <pre>docker-compose -f C:\Users\user\IdeaProjects\Cloud\docker-compose.yaml up</pre>

<p>
Если вы хотите вносить изменения в проект и запускать его локально, то вам будет необходимо 
либо пересобирать docker-образ каждый раз, либо вынести backend-сервис из docker-compose файла и запускать приложение 
отдельно от окружения в Docker. 
Также для запуска вам понадобится .env-файл. 
</p>

Пример .env-файла:

<pre>
DB_USER=admin
DB_PASS=pass
DB_URL=jdbc:postgresql://postgres:5432/postgres

REDIS_URL=redis
REDIS_PORT=6379
REDIS_PASS=pass

MINIO_URL=http://minio:9000
MINIO_USER=admin
MINIO_PASS=pass
</pre>

<h2>Фронтенд</h2>

<p>
В проекте используется <a href="https://github.com/MrShoffen/roadmap-cloud-storage-frontend">готовый фронтенд</a>. 
Но мной были внесены минимальные правки, чтобы фронтенд нормально работал с моим бэкендом, форк находится вот <a href="https://github.com/GogAndMagog/cloud-frontend-2">здесь</a>. 
Он может понадобиться вам, если вы захотите вносить какие-то свои правки в проект.
</p>

<h2>Что удалось вынести из проекта:</h2>

<ul>
<li>
<p>
Получилось написать проект в MVС-стиле, максимально приближенный к рабочему.
</p>
</li>
<li>
<p>
Использоание @ControllerAdvice как единой точки отказа приложения.
</p>
</li>
<li>
<p>
Интеграция Redis для хранения сессий, а также их сериализация/десериализация в JSON - для наглядности.
</p>
</li>
<li>
<p>
Работа со Spring Security, хоть какой-то опыт работы с ним. (Сама технология неоднозначная) 
</p>
</li>
<li>
<p>
Попытка построения абстракции Репозитория над S3-клиентами. 
Сами создатели Spring говорят, что в этом нет надобности и поэтому они не реализовали эту абстракцию сами. 
Но мне её не хватало и я её написал, хоть и не идеально. Абстракция протекла и в Репозитории у меня существует метод 
для создания Директорий, хотя Репозиторий должен уметь работать только с ресурсами. По хорошему надо вынести этот метод 
на слой Сервисов, но т.к. это пет-проект и я уже очень сильно его затянул, то оставлю так.  
</p>
</li>
<li>
<p>
Попытка разработки по TDD себя не оправдала, не получилось держать сразу весь компонент в голове и задизайнить его так, 
чтобы потом было бы удобно с ним работать и не приходилось бы править. Это вызвало фрустрацию и забитие на проект где-то 
на месяц.
</p>

<p>
Помог ментор, который посоветовал реализовывать приложение, реализуя конкретные эндпоинты. Да, так внедряя всего одну функцию 
- нужно затрагивать сразу несколько компонентов, но получалось закрывать по одному эндпоинту в день и работа возобновилась. 
</p>
</li>
<li>
<p>
Реализация работы с путями к ресурсам, интегрированная с Minio была создана, как прописано в ТЗ. 
Но сейчас бы я вынес работу с путями в отдельный компонент с использованием для хранения путей какой-нибудь БД, 
а на Minio оставил бы только хранение файлов.
</p>
</li>
<li>
<p>
Попытка в тестирование не реализаций, но интерфейсов. Получилось написать некоторые тесты для абстракции S3-репозитория, 
потенциально так можно тестировать все реализации этого интерфейса, с помощью параметризированных тестов. 
</p>
</li>
<li>
<p>
Написание интеграционных тестов, используя Базовый Абстрактный Тестовый класс, для поднятия контекста приложения только 
один раз, для всех тестов, с данными параметрами контекста. Использование Тестконтейнеров, для поднятия окружения 
приложения вынесено в отдельную конфигурацию, для его переиспользования в других интеграционных тестах. 
</p>
</li>
</ul>

<h1>ВНИМАНИЕ</h1>
<p>
Спасибо за внимание. 
</p>